"use strict";(self.webpackChunkav_docusaurus_classic=self.webpackChunkav_docusaurus_classic||[]).push([[1593],{2389:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>l,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"system-design/software/rabbitmq/rabbitmq","title":"RabbitMQ","description":"Message broker for message queueing.","source":"@site/docs/system-design/software/rabbitmq/rabbitmq.md","sourceDirName":"system-design/software/rabbitmq","slug":"/system-design/software/rabbitmq/","permalink":"/av-docs/docs/system-design/software/rabbitmq/","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/system-design/software/rabbitmq/rabbitmq.md","tags":[],"version":"current","frontMatter":{},"sidebar":"systemDesignSidebar","previous":{"title":"Kafka","permalink":"/av-docs/docs/system-design/software/kafka/"},"next":{"title":"GraphQL - Query Language & Runtime","permalink":"/av-docs/docs/system-design/software/graphql/"}}');var i=n(4848),a=n(8453);const o={},r="RabbitMQ",c={},d=[{value:"Use cases",id:"use-cases",level:2},{value:"Weaknesses",id:"weaknesses",level:3},{value:"Main benefits",id:"main-benefits",level:2},{value:"Mechanism",id:"mechanism",level:2}];function h(e){const s={a:"a",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"rabbitmq",children:"RabbitMQ"})}),"\n",(0,i.jsxs)(s.p,{children:["Message broker for ",(0,i.jsx)(s.a,{href:"/av-docs/docs/system-design/concepts/message-queue",children:"message queueing"}),"."]}),"\n",(0,i.jsx)(s.p,{children:"RabbitMQ is an implementation of the AMQP(advanced message queueing protocol) message model(version 0.9.1), In memory message broker."}),"\n",(0,i.jsx)(s.p,{children:"Ideal for direct, real-time processing task-based communication, especially with synchronous request-response interactions. Often in microservices that need rapid message acknowledgment and delivery, but avoid to be forced performing intensive tasks on the spot and blocking the service by potentially taking long time."}),"\n",(0,i.jsx)(s.h2,{id:"use-cases",children:"Use cases"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Simply upload picture to the app, but the image needs to be scaled first for web and mobile applications. The message to scale is sent into queue, then scaling service subscribes to it and scales it. Messages can be taken one-by-one or in batches."}),"\n",(0,i.jsx)(s.li,{children:"User requests for a PDF to be created(could be tickets, receipt, book or other readings), message sent to RabbitMQ queue, PDF services subscribes to it, generates pdf and sends it via email."}),"\n",(0,i.jsx)(s.li,{children:"In an online ordering system, RabbitMQ can handle the processing pipeline, such as order fulfillment, sending emails, or updating inventory, where each task needs to be completed sequentially and acknowledged."}),"\n",(0,i.jsx)(s.li,{children:"In a banking app, RabbitMQ can handle the flow between services, such as triggering notifications after a transaction or processing requests for balance updates. Its lower latency makes it effective for synchronous, fast-paced message handling."}),"\n",(0,i.jsx)(s.li,{children:"Uploading video to youtube, all the backend has to do is encode the videos and store them."}),"\n",(0,i.jsx)(s.li,{children:"Posting on facebook, all the backend cares is to store it and push it to user newsfeed cache."}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"weaknesses",children:"Weaknesses"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Does not keep messages long-term, messages are deleted once consumed."}),"\n",(0,i.jsx)(s.li,{children:"Queue sizes are generally limited, and performance degrades with larger queues. This makes it unsuitable for scenarios where multiple consumers need to access both recent and old messages at different times."}),"\n",(0,i.jsx)(s.li,{children:"Uses Round robin delivery method which leads to more throughput, but does not ensure in-order message processing. Using fan-out can solve it, but throughput is reduced."}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"main-benefits",children:"Main benefits"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"One of main benefits is tremendous amount of flexibility you have moving messages through your system."}),"\n",(0,i.jsx)(s.li,{children:"How the message has to go through the system is largely a part of the message metadata. In the checkout app example, it is the application and the developer that has a lot of control with the way messages move through the system rather than the broker administrator."}),"\n",(0,i.jsx)(s.li,{children:"RabbitMQ is cloud friendly, meanings it is easy to get started, we can deploy an instance of it on Docker or other containerization software or it can run as a clster for fault-tolerance, high-availability and high throughput."}),"\n",(0,i.jsx)(s.li,{children:'Cross-language communication with extensive library and good security. Producer checkout can be "Go app", and consumers of inventory "Javascript App" and shipping "Python app".'}),"\n",(0,i.jsx)(s.li,{children:"Security. Supports FASL, LDAP and TLS for authentication and authorization."}),"\n",(0,i.jsx)(s.li,{children:"Message acknowledgements. When a message is in a queue and goes to the consumer, the message stays in the queue until the consumer lets the broker know that it has received the message, and only then the message taken out of queue. That prevents the system from losing any messages."}),"\n",(0,i.jsx)(s.li,{children:"Great Management. Browser based management UI, as well as incentinve CLI tools and many open source plugins enhancing RabbitMQ, even supporting other message models (MQTT, Stomp, AMQP1.0)."}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"mechanism",children:"Mechanism"}),"\n",(0,i.jsxs)(s.p,{children:["Service that produces the messages, instead of producing directly to a ",(0,i.jsx)(s.strong,{children:"message queue"}),", it is going to produce to an ",(0,i.jsx)(s.strong,{children:"exchange"}),".\n",(0,i.jsx)(s.strong,{children:"Exchange"})," is going to receive all the messages and distribute them according to how they are addressed. An exchange can be connected via ",(0,i.jsx)(s.strong,{children:"bindings"})," to many ",(0,i.jsx)(s.strong,{children:"queues"})," which are connected to the consuming service, the consumers."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Example Checkout App design"}),":"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Checkout (Producer),"}),"\n",(0,i.jsx)(s.li,{children:"Exchange,"}),"\n",(0,i.jsx)(s.li,{children:"Queues(2),"}),"\n",(0,i.jsx)(s.li,{children:"Inventory(Consumer),"}),"\n",(0,i.jsx)(s.li,{children:"Shipping(Consumer)."}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Checkout sends message to exchange, the exchange is connected to queues via connection bindings and these can be referenced by the ",(0,i.jsx)(s.strong,{children:"binding key"}),". Consumer service subscribe to the queues."]}),"\n",(0,i.jsx)(s.p,{children:"Exchange and queues is RabbitMQ message broker of the system.\nSystem model enables flexible messages due to different types of exchange."}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Fanout exchange"})," - checkout produced message will go to the exchange, where it will be duplicated and sent to every single queue that it knows about."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Direct exchange"})," - checkout will produce the message and then that message will get a ",(0,i.jsx)(s.strong,{children:"routing key"})," which is being compared to the ",(0,i.jsx)(s.strong,{children:"binding key"})," and if it is an exact match, then the message will move through the system accordingly."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Topic exchange"})," - we can do a partial match between the routing key and the binding key. A routing key on the message called ship.shoes and the binding key ship.any would get that message routed through that particular topic queue."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Header exchange"})," - the routing key is ignored completely and the message is moved through the system according to the header."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Default/Nameless exchange"})," - unique to RabbitMQ. for example the routing key is 'inv' which is tied to the name of the queue itself."]})]})}function l(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>r});var t=n(6540);const i={},a=t.createContext(i);function o(e){const s=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(a.Provider,{value:s},e.children)}}}]);